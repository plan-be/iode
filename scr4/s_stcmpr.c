#include "s_strs.h"

unsigned char   SCR_ALTSEQ[] = {
	    /* 00     */ ' ',
	    /* 01     */ ' ',
	    /* 02     */ ' ',
	    /* 03     */ ' ',
	    /* 04     */ ' ',
	    /* 05     */ ' ',
	    /* 06     */ ' ',
	    /* 07     */ ' ',
	    /* 08     */ ' ',
	    /* 09     */ ' ',
	    /* 0a     */ ' ',
	    /* 0b     */ ' ',
	    /* 0c     */ ' ',
	    /* 0d     */ ' ',
	    /* 0e     */ ' ',
	    /* 0f     */ ' ',
	    /* 10     */ ' ',
	    /* 11     */ ' ',
	    /* 12     */ ' ',
	    /* 13     */ ' ',
	    /* 14     */ ' ',
	    /* 15     */ ' ',
	    /* 16     */ ' ',
	    /* 17     */ ' ',
	    /* 18     */ ' ',
	    /* 19     */ ' ',
	    /* 1a     */ ' ',
	    /* 1b     */ ' ',
	    /* 1c     */ ' ',
	    /* 1d     */ ' ',
	    /* 1e     */ ' ',
	    /* 1f     */ ' ',
	    /* 20 ( ) */ ' ',
	    /* 21 (!) */ ' ',
	    /* 22 (") */ ' ',
	    /* 23 (#) */ ' ',
	    /* 24 ($) */ ' ',
	    /* 25 (%) */ ' ',
	    /* 26 (&) */ ' ',
	    /* 27 (') */ ' ',
	    /* 28 (() */ ' ',
	    /* 29 ()) */ ' ',
	    /* 2a (*) */ ' ',
	    /* 2b (+) */ ' ',
	    /* 2c (,) */ ' ',
	    /* 2d (-) */ ' ',
	    /* 2e (.) */ ' ',
	    /* 2f (/) */ ' ',
	    /* 30 (0) */ '0',
	    /* 31 (1) */ '1',
	    /* 32 (2) */ '2',
	    /* 33 (3) */ '3',
	    /* 34 (4) */ '4',
	    /* 35 (5) */ '5',
	    /* 36 (6) */ '6',
	    /* 37 (7) */ '7',
	    /* 38 (8) */ '8',
	    /* 39 (9) */ '9',
	    /* 3a (:) */ ' ',
	    /* 3b (;) */ ' ',
	    /* 3c (<) */ ' ',
	    /* 3d (=) */ ' ',
	    /* 3e (>) */ ' ',
	    /* 3f (?) */ ' ',
	    /* 40 (@) */ ' ',
	    /* 41 (A) */ 'A',
	    /* 42 (B) */ 'B',
	    /* 43 (C) */ 'C',
	    /* 44 (D) */ 'D',
	    /* 45 (E) */ 'E',
	    /* 46 (F) */ 'F',
	    /* 47 (G) */ 'G',
	    /* 48 (H) */ 'H',
	    /* 49 (I) */ 'I',
	    /* 4a (J) */ 'J',
	    /* 4b (K) */ 'K',
	    /* 4c (L) */ 'L',
	    /* 4d (M) */ 'M',
	    /* 4e (N) */ 'N',
	    /* 4f (O) */ 'O',
	    /* 50 (P) */ 'P',
	    /* 51 (Q) */ 'Q',
	    /* 52 (R) */ 'R',
	    /* 53 (S) */ 'S',
	    /* 54 (T) */ 'T',
	    /* 55 (U) */ 'U',
	    /* 56 (V) */ 'V',
	    /* 57 (W) */ 'W',
	    /* 58 (X) */ 'X',
	    /* 59 (Y) */ 'Y',
	    /* 5a (Z) */ 'Z',
	    /* 5b ([) */ ' ',
	    /* 5c (\) */ ' ',
	    /* 5d (]) */ ' ',
	    /* 5e (^) */ ' ',
	    /* 5f (_) */ ' ',
	    /* 60 (`) */ ' ',
	    /* 61 (a) */ 'A',
	    /* 62 (b) */ 'B',
	    /* 63 (c) */ 'C',
	    /* 64 (d) */ 'D',
	    /* 65 (e) */ 'E',
	    /* 66 (f) */ 'F',
	    /* 67 (g) */ 'G',
	    /* 68 (h) */ 'H',
	    /* 69 (i) */ 'I',
	    /* 6a (j) */ 'J',
	    /* 6b (k) */ 'K',
	    /* 6c (l) */ 'L',
	    /* 6d (m) */ 'M',
	    /* 6e (n) */ 'N',
	    /* 6f (o) */ 'O',
	    /* 70 (p) */ 'P',
	    /* 71 (q) */ 'Q',
	    /* 72 (r) */ 'R',
	    /* 73 (s) */ 'S',
	    /* 74 (t) */ 'T',
	    /* 75 (u) */ 'U',
	    /* 76 (v) */ 'V',
	    /* 77 (w) */ 'W',
	    /* 78 (x) */ 'X',
	    /* 79 (y) */ 'Y',
	    /* 7a (z) */ 'Z',
	    /* 7b ({) */ ' ',
	    /* 7c (|) */ ' ',
	    /* 7d (}) */ ' ',
	    /* 7e (~) */ ' ',
	    /* 7f () */ ' ',
	    /* 80 (Ä) */ 'C',
	    /* 81 (Å) */ 'U',
	    /* 82 (Ç) */ 'E',
	    /* 83 (É) */ 'A',
	    /* 84 (Ñ) */ 'A',
	    /* 85 (Ö) */ 'A',
	    /* 86 (Ü) */ 'A',
	    /* 87 (á) */ 'C',
	    /* 88 (à) */ 'E',
	    /* 89 (â) */ 'E',
	    /* 8a (ä) */ 'E',
	    /* 8b (ã) */ 'I',
	    /* 8c (å) */ 'I',
	    /* 8d (ç) */ 'I',
	    /* 8e (é) */ 'A',
	    /* 8f (è) */ 'A',
	    /* 90 (ê) */ 'E',
	    /* 91 (ë) */ 'A',
	    /* 92 (í) */ 'A',
	    /* 93 (ì) */ 'O',
	    /* 94 (î) */ 'O',
	    /* 95 (ï) */ 'O',
	    /* 96 (ñ) */ 'U',
	    /* 97 (ó) */ 'U',
	    /* 98 (ò) */ 'Y',
	    /* 99 (ô) */ 'O',
	    /* 9a (ö) */ 'U',
	    /* 9b (õ) */ ' ',
	    /* 9c (ú) */ ' ',
	    /* 9d (ù) */ ' ',
	    /* 9e (û) */ ' ',
	    /* 9f (ü) */ ' ',
	    /* a0 (†) */ 'A',
	    /* a1 (°) */ 'I',
	    /* a2 (¢) */ 'O',
	    /* a3 (£) */ 'U',
	    /* a4 (§) */ 'N',
	    /* a5 (•) */ 'N',
	    /* a6 (¶) */ ' ',
	    /* a7 (ß) */ ' ',
	    /* a8 (®) */ ' ',
	    /* a9 (©) */ ' ',
	    /* aa (™) */ ' ',
	    /* ab (´) */ ' ',
	    /* ac (¨) */ ' ',
	    /* ad (≠) */ ' ',
	    /* ae (Æ) */ ' ',
	    /* af (Ø) */ ' ',
	    /* b0 (∞) */ ' ',
	    /* b1 (±) */ ' ',
	    /* b2 (≤) */ ' ',
	    /* b3 (≥) */ ' ',
	    /* b4 (¥) */ ' ',
	    /* b5 (µ) */ ' ',
	    /* b6 (∂) */ ' ',
	    /* b7 (∑) */ ' ',
	    /* b8 (∏) */ ' ',
	    /* b9 (π) */ ' ',
	    /* ba (∫) */ ' ',
	    /* bb (ª) */ ' ',
	    /* bc (º) */ ' ',
	    /* bd (Ω) */ ' ',
	    /* be (æ) */ ' ',
	    /* bf (ø) */ ' ',
	    /* c0 (¿) */ ' ',
	    /* c1 (¡) */ ' ',
	    /* c2 (¬) */ ' ',
	    /* c3 (√) */ ' ',
	    /* c4 (ƒ) */ ' ',
	    /* c5 (≈) */ ' ',
	    /* c6 (∆) */ ' ',
	    /* c7 («) */ ' ',
	    /* c8 (») */ ' ',
	    /* c9 (…) */ ' ',
	    /* ca ( ) */ ' ',
	    /* cb (À) */ ' ',
	    /* cc (Ã) */ ' ',
	    /* cd (Õ) */ ' ',
	    /* ce (Œ) */ ' ',
	    /* cf (œ) */ ' ',
	    /* d0 (–) */ ' ',
	    /* d1 (—) */ ' ',
	    /* d2 (“) */ ' ',
	    /* d3 (”) */ ' ',
	    /* d4 (‘) */ ' ',
	    /* d5 (’) */ ' ',
	    /* d6 (÷) */ ' ',
	    /* d7 (◊) */ ' ',
	    /* d8 (ÿ) */ ' ',
	    /* d9 (Ÿ) */ ' ',
	    /* da (⁄) */ ' ',
	    /* db (€) */ ' ',
	    /* dc (‹) */ ' ',
	    /* dd (›) */ ' ',
	    /* de (ﬁ) */ ' ',
	    /* df (ﬂ) */ ' ',
	    /* e0 (‡) */ 'A',
	    /* e1 (·) */ 'B',
	    /* e2 (‚) */ 'G',
	    /* e3 („) */ 'P',
	    /* e4 (‰) */ 'S',
	    /* e5 (Â) */ 'S',
	    /* e6 (Ê) */ 'M',
	    /* e7 (Á) */ 'G',
	    /* e8 (Ë) */ 'F',
	    /* e9 (È) */ 'T',
	    /* ea (Í) */ 'O',
	    /* eb (Î) */ 'D',
	    /* ec (Ï) */ ' ',
	    /* ed (Ì) */ 'F',
	    /* ee (Ó) */ 'E',
	    /* ef (Ô) */ ' ',
	    /* f0 () */ ' ',
	    /* f1 (Ò) */ ' ',
	    /* f2 (Ú) */ ' ',
	    /* f3 (Û) */ ' ',
	    /* f4 (Ù) */ ' ',
	    /* f5 (ı) */ ' ',
	    /* f6 (ˆ) */ ' ',
	    /* f7 (˜) */ ' ',
	    /* f8 (¯) */ ' ',
	    /* f9 (˘) */ ' ',
	    /* fa (˙) */ ' ',
	    /* fb (˚) */ ' ',
	    /* fc (¸) */ ' ',
	    /* fd (˝) */ ' ',
	    /* fe (˛) */ ' ',
	    /* ff (ˇ) */ 0xFF           /* JMP_M 4.19 03-06-95 */
	    };

/* ====================================================================
Fonction utilisÇe pour dÇfinir les index SQZ dans les ISAM. Le string
str de lg caractäres est transformÇ en res en supprimant tous les
caractäres non alphanumÇriques et en mettant tous les caractäres
minuscules en majuscule. Les caractäres de fin sont remplacÇs par des
blancs.

Il n'y a pas de '\0' placÇ Ö la fin du string.

&RT le pointeur vers le rÇsultat res
&EX
    SCR_compress("de Biolley M.", buf, 13);

    buf vaut : "DEBIOLLEYM   "
&TX
&SA SCR_zstrip(), SCR_sqz()
=======================================================================*/

unsigned char *SCR_compress(res, str, lg)
unsigned char *res, *str;
int             lg;
{
    int     i, j;

    for(i = 0, j = 0 ; i < lg; i++) {
	if(str[i] == 0) break;              /* JMP 15-09-93 */
	res[j] = SCR_ALTSEQ[str[i]];
	if(res[j] != ' ') j++;
	}
    for( ; j < lg; j++) res[j] = ' ';
    return(res);
}

/*NH*/
unsigned char *SCR_compress2(res, str, lg)
unsigned char *res, *str;
int             lg;
{
    int     i, j;

    SCR_ALTSEQ[37] = '%';
    for(i = 0, j = 0 ; i < lg; i++) {
	if(str[i] == 0) break;
	res[j] = SCR_ALTSEQ[str[i]];
	if(res[j] != ' ') j++;
	}
    for( ; j < lg; j++) res[j] = ' ';
    SCR_ALTSEQ[25] = ' ';
    return(res);
}


