<!-- This content was generated by scr4w_amd -->

# Table of Contents



- [IODE: Estimation](#T1)
    - [Estimation process](#T2)
    - [k\_est.c](#T3)
    - [e\_estim.c](#T4)
      - [List of global variables](#T5)
    - [e\_prep.c](#T6)
    - [e\_tests.c](#T7)
    - [e\_error.c](#T8)
    - [e\_print.c](#T9)
    - [e\_dftest.c](#T10)
    - [e\_step.c](#T11)

# IODE: Estimation {#T1}

Most functions in this group are based on the book "Specification, Estimation and Analysis of Macroeconomic Models" by Fair (1984).

Four methods are currently proposed in IODE for the estimation of a block of equations:

- 0: LSQ
- 1: Zellner (2SLS?)
- 2: Instrumental Variables (IV)
- 3: GLS (3SLS)

No differences are made between linear and non linear equations: in both cases, the jacobian of the system is computed numerically.

The functions related to estimation are divided in the following source files:

- k\_est.c: functions linking the estimation package (e\_\*.c) to the workspaces of EQ and SCL
- e\_estim.c: main estimation functions
- e\_prep.c: construction (and destruction) of the matrices needed during the estimation process
- e\_tests.c: calculation of statistical tests
- e\_error.c: functions to send error messages
- e\_print.c: functions to print the estimation results
- e\_dftest.c: implementation of the Dickey\-Fuller test
- e\_step.c: moved to the report functions

### Estimation process {#T2}

The main function is KE\_estim() or KE\_est\_s() which is a more general version of KE\_estim(). KE\_est\_s() first extracts from the current equations in KE\_WS the informations needed to start the estimation:

- equations in LEC form,
- instruments in LEC (if any),
- estimation method,
- sample if not passed as argument

KE\_est\_s() then calls the function E\_est() to (try to) estimate the coefficients. E\_est() first gets the needed variables and scalars from KV\_WS and KS\_WS and then starts the estimation iteration. If a solution is reached,

- the coefficients are saved in KS\_WS
- E\_output() is called to save the statistical tests in global matrices

The control returns to KE\_est\_s() which, if the solution is reached, calls E\_print\_results() to save in A2m a selection of results. Finally, the statistical tests related to each equation are stored in the equations themselves.

Moreover, the same tests are saved in "volatile" scalars and variables:

- equation tests in scalars e<eqnb>\_<testname> (e.g.: e0\_dw, e1\_r2...)
- calculated, observed and residual values in variables \_YCALC, \_YOBS and \_YRES

These scalars and variables are "volatile" in the sense that they will be replaced in the next estimation.

### k\_est.c {#T3}

These functions link the data in the current workspaces (EQ, SCL) and the estimation package.

Before starting the estimation itself, the values of the coefficients, the LEC forms, the estimation methods, etc, are read from the EQ and the SCL in the current workspaces.

After the estimation, if a solution is found, the results are stored in the workspaces by the functions in that group.

|Syntax|Description|
|:---|:---|
|`int KE_est_s(KDB* dbe, KDB* dbv, KDB* dbs, SAMPLE* smpl, char** names)`|Estimates an equation or a block of equations|
|`int KE_estim(char* veqs, char* afrom, char* ato)`|Estimates an equation or a block of equations on the specified sample. Simplified version of KE\_est\_s()|
|**Utility function**||
|`void E_tests2scl(EQ* eq, int j, int n, int k)`|Creates the scalars containing the results of an estimated equation|

### e\_estim.c {#T4}

Main estimation functions \+ some utilities.

|Syntax|Description|
|:---|:---|
|`int E_est(char** endos, char** lecs, KDB* dbv, KDB* dbs, SAMPLE* smpl, int met, char** instrs, int maxit, double eps)`|Estimates a block of equations|
|**Utility function**||
|`int E_scl_in_eq(int coef_nb, int eq_nb)`|Checks if the coefficient coef\_nb is in the equation eq\_nb.|

#### List of global variables {#T5}

|Declaration|Description|
|:---|:---|
|`int E_errno;`|Last estimation error number (between E\_NO\_EQ\_ERR and E\_NO\_SCALARS|
|`int E_NEQ;`|Number of equations in the current block of equations|
|`int E_NCE;`|Number of estimated coefficients in the current block of equations|
|`int E_NC;`|Number of coefficients (est and non est) in the current block of equations|
|`int E_NINSTR;`|Number of instruments in the estimation|
|`int E_T;`|Number of periods in the estimation sample|
|`int E_FROM;`|Position in E\_DBV of the first period in the estimation sample|
|`int *E_C_NBS;`|Positions in E\_DBS of the estimated coefs|
|`KDB *E_DBV;`|KDB of variables used for the estimation|
|`KDB *E_DBS;`|KDB of scalars used for the estimation|
|`SAMPLE *E_SMPL;`|Current estimation sample|
|`char E_MET;`|Current estimation method|
|`IODE_REAL E_CONV_TEST;`|Sum of the squares of the relative differences between 2 iterations|
|`IODE_REAL E_EPS;`|Convergence criterion (threshold) for the estimation|
|`CLEC **E_CRHS;`|List of CLEC corresponding to the right members of the equations|
|`char **E_LECS;`|List (block) of simultaneous equations of the current estimation|
|`char **E_INSTRS;`|List of instruments (LEC formulas) of the current estimation|
|`char **E_ENDOS;`|List of endogenous vars of the current estimation|
|`MAT* E_C`|Vector of of estimated coefficients|
|`MAT* E_SMO`|Vector of of relaxation params|
|`MAT* E_U`|Residuals (neq x t)|
|`MAT* E_VCU`|Variance / covariance of the residuals (neq x neq)|
|`MAT* E_IVCU`|Inverse of E\_VCU|
|`MAT* E_RHS`|Right side of equations (neq x t)|
|`MAT* E_G`|Jacobian matrix of the system|
|`MAT* E_VCC`|Var/covar of the coefficients|
|`MAT* E_dC`|Vector of coefficient increments|
|`MAT* E_DF`|Degrees of freedom of each coefficient|
|`MAT* E_STDERR`|Std error of each equation|
|`MAT* E_SSRES`|Sum of squares of residuals of each eq|
|`MAT* E_MEAN_Y`|Mean of the LHS on each equation|
|`MAT* E_STDEV`|Std deviation of each equation|
|`MAT* E_RSQUARE`|R\-square of each equation|
|`MAT* E_RSQUARE_ADJ`|Adjusted R\-square of each equation|
|`MAT* E_DW`|Durbin\-Watson test of each equation|
|`MAT* E_FSTAT`|F\-Stat of each equation|
|`MAT* E_LOGLIK`|Log\-likelihood of each equation|
|`MAT* E_STD_PCT`|Standard errors in % for each equation|
|`MAT* E_MCORR`|Correlation matrix bw coefficients|
|`MAT* E_MCORRU`|Correlation matrix bw error terms of equations|
|`MAT* E_DEV`|Deviation between observed and calculated values|

### e\_prep.c {#T6}

Construction (and destruction) of the matrices needed during the estimation process \+ some utility functions to get/put the coefficients values in KS\_WS.

|Syntax|Description|
|:---|:---|
|`int E_prep(char** lecs, char** instrs)`|Prepares the estimation of a group a equations.|
|`void E_get_C()`|Saves in E\_C the values of the estimated coefficients.|
|`void E_put_C()`|Stores in E\_DBS the values of the coefficients in E\_C.|
|`void E_get_SMO()`|Saves in E\_SMO the relaxation parameters of each coefficient of the equation block.|
|`void E_free_work()`|Frees all allocated variables for the last estimation.|

### e\_tests.c {#T7}

Computation of statistical tests.

|Syntax|Description|
|:---|:---|
|`int E_output()`|Computes the statistical tests after an estimation and saves the tests in MAT objects.|
|**Utilities**||
|`double M_c_line(MAT* m1, int line, int oper)`|Adds, substracts or multiplies all elements of a matrix line.|
|`double E_div_0(double a, double b)`|Divides a by b if b is not null. If b is null, returns 0.0.|
|`double E_sqrt(double val)`|Returns the square root of val if val >= 0. If not, returns 0.0.|

### e\_error.c {#T8}

Functions to send information and error messages from estimation functions.

|Syntax|Description|
|:---|:---|
|`void E_msg(char* fmt,...)`|Displays a message using kmsg().|
|`void E_error(char* fmt,...)`|Displays an estimation error message using B\_seterror().|

### e\_print.c {#T9}

Functions to generate the results of an estimation in A2M format.

|Syntax|Description|
|:---|:---|
|`int E_graph(char** titles, SAMPLE* smpl, MAT* mlhs, MAT* mrhs, int view, int res)`|Displays or prints the graphs of residuals or observed / fitted values|
|`int E_print_results(int corr, int corru, int obs, int grobs, int grres)`|Prints the estimation input and output of a block of equations.|

### e\_dftest.c {#T10}

Implementation of the Dickey\-Fuller test (presence of a unit root in an autoregressive time series model).

|Syntax|Description|
|:---|:---|
|`IODE_REAL *E_UnitRoot(char* varname, int drift, int trend, int order)`|implementation of the Dickey\-Fuller test|
|`void E_PrintDF(char* lec, IODE_REAL* res, int drift, int trend, int order)`|prints the results of the Dickey\-Fuller test|
|**Utility functions**||
|`int E_GetLecName(char* lec, char* name)`|retrieves the name of the first variable in a lec expression|
|`void E_SclToReal(char* name, IODE_REAL* res)`|stores the content of a scalar in a vector of doubles|

### e\_step.c {#T11}

Function to select the coefficients to be estimated in an equation: for a given equation, different combination of "estimated" (i.e. relax <> 0) coefficients are tested and the selected combination must: \- verify a given condition and \- give the best statistical test (fstat or r2)

The selection is done by blocking all possible combinaisons of coefficients.

|Syntax|Description|
|:---|:---|
|`IODE_REAL C_evallec(char* lec, int t)`|Evaluates a LEC expression at a specific period of time.|
|`IODE_REAL E_StepWise(SAMPLE* smpl, char* eqname, char* cond, char* test)`|For a given equation, tries all combinations of coefficients and saves the coefficient configuration that gives the best statistical result (for a chosen test)|

